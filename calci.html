<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Calculator</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for a better look and feel */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent; /* Removes tap highlight on mobile */
        }
        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 1rem;
        }
        .btn {
            transition: background-color 0.2s ease-in-out, transform 0.1s ease;
        }
        .btn:active {
            transform: scale(0.95);
        }
        /* Style for the display to prevent text selection */
        #display {
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE10+/Edge */
            user-select: none; /* Standard */
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen">

    <!-- Calculator Body -->
    <div class="w-full max-w-sm mx-auto bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 space-y-6">
        
        <!-- Display Screen -->
        <div id="display-container" class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4 text-right">
            <input type="text" id="display" class="w-full bg-transparent text-gray-800 dark:text-gray-100 text-5xl font-light border-none outline-none text-right" readonly placeholder="0">
        </div>

        <!-- Buttons Grid -->
        <div class="calculator-grid">
            <!-- Row 1 -->
            <button onclick="clearDisplay()" class="btn text-2xl bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">C</button>
            <button onclick="appendCharacter('/')" class="btn text-2xl bg-orange-500 hover:bg-orange-600 text-white rounded-lg p-4 shadow-md">÷</button>
            <button onclick="appendCharacter('*')" class="btn text-2xl bg-orange-500 hover:bg-orange-600 text-white rounded-lg p-4 shadow-md">×</button>
            <button onclick="deleteLast()" class="btn text-2xl bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">DEL</button>
            
            <!-- Row 2 -->
            <button onclick="appendCharacter('7')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">7</button>
            <button onclick="appendCharacter('8')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">8</button>
            <button onclick="appendCharacter('9')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">9</button>
            <button onclick="appendCharacter('-')" class="btn text-2xl bg-orange-500 hover:bg-orange-600 text-white rounded-lg p-4 shadow-md">−</button>

            <!-- Row 3 -->
            <button onclick="appendCharacter('4')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">4</button>
            <button onclick="appendCharacter('5')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">5</button>
            <button onclick="appendCharacter('6')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">6</button>
            <button onclick="appendCharacter('+')" class="btn text-2xl bg-orange-500 hover:bg-orange-600 text-white rounded-lg p-4 shadow-md">+</button>

            <!-- Row 4 -->
            <button onclick="appendCharacter('1')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">1</button>
            <button onclick="appendCharacter('2')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">2</button>
            <button onclick="appendCharacter('3')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">3</button>
            <button onclick="calculateResult()" class="btn text-2xl bg-orange-500 hover:bg-orange-600 text-white rounded-lg p-4 shadow-md" style="grid-row: span 2;">=</button>

            <!-- Row 5 -->
            <button onclick="appendCharacter('0')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md" style="grid-column: span 2;">0</button>
            <button onclick="appendCharacter('.')" class="btn text-2xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-lg p-4 shadow-md">.</button>
        </div>
    </div>

    <script>
        // Get the display element from the DOM
        const display = document.getElementById('display');

        /**
         * Appends a character to the display input.
         * @param {string} character - The character to append.
         */
        function appendCharacter(character) {
            // Prevent multiple operators in a row or multiple decimals
            const lastChar = display.value.slice(-1);
            const operators = ['+', '-', '*', '/'];
            if (operators.includes(character) && operators.includes(lastChar)) {
                // Replace the last operator with the new one
                display.value = display.value.slice(0, -1) + character;
                return;
            }
            if (character === '.' && display.value.includes('.')) {
                 // Don't allow more than one decimal point in a number segment
                 const segments = display.value.split(/[+\-*/]/);
                 if (segments[segments.length - 1].includes('.')) return;
            }

            display.value += character;
        }

        /**
         * Clears the entire display.
         */
        function clearDisplay() {
            display.value = '';
        }

        /**
         * Deletes the last character from the display.
         */
        function deleteLast() {
            display.value = display.value.slice(0, -1);
        }

        /**
         * Calculates the result of the expression in the display.
         * Uses a safe evaluation method to prevent security risks.
         */
        function calculateResult() {
            try {
                // Replace custom multiplication and division symbols with standard ones for evaluation
                let expression = display.value.replace(/×/g, '*').replace(/÷/g, '/');

                // Basic validation to prevent eval on empty or operator-only strings
                if (!expression || /[+\-*/.]$/.test(expression)) {
                    throw new Error("Invalid expression");
                }
                
                // Using Function constructor for safer evaluation than direct eval()
                const result = new Function('return ' + expression)();

                // Check for invalid results like Infinity or NaN
                if (!isFinite(result)) {
                    throw new Error("Cannot divide by zero");
                }
                
                // Format result to a reasonable number of decimal places if it's a float
                display.value = parseFloat(result.toPrecision(12));

            } catch (error) {
                // If an error occurs, briefly show 'Error' on the display
                const originalValue = display.value;
                display.value = 'Error';
                setTimeout(() => {
                    display.value = originalValue;
                }, 1500);
            }
        }

        // --- Keyboard Support ---
        document.addEventListener('keydown', (event) => {
            const key = event.key;

            if (key >= '0' && key <= '9') {
                appendCharacter(key);
            } else if (key === '.') {
                appendCharacter('.');
            } else if (key === '+' || key === '-') {
                appendCharacter(key);
            } else if (key === '*') {
                appendCharacter('*');
            } else if (key === '/') {
                event.preventDefault(); // Prevent browser's find-as-you-type feature
                appendCharacter('/');
            } else if (key === 'Enter' || key === '=') {
                event.preventDefault(); // Prevent form submission if it's in a form
                calculateResult();
            } else if (key === 'Backspace') {
                deleteLast();
            } else if (key === 'Escape' || key.toLowerCase() === 'c') {
                clearDisplay();
            }
        });
    </script>

</body>
</html>